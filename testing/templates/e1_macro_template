# SPDX-FileCopyrightText: 2023 CERN
# SPDX-License-Identifier: Apache-2.0
#  example23.in
#

## =============================================================================
## Geant4 macro for modelling simplified sampling calorimeters
## =============================================================================
##
/run/numberOfThreads $num_threads
/control/verbose 0
/run/verbose 0
/process/verbose 0
/tracking/verbose 0
/event/verbose 0

/detector/filename $gdml_file
# Temporary workaround since we don't have a G4 to VecGeom converter
/$ui_dir/setVecGeomGDML $gdml_file
/$ui_dir/setVerbosity 0
## Threshold for buffering tracks before sending to GPU
/$ui_dir/setTransportBufferThreshold $adept_threshold
## Total number of GPU track slots (not per thread)
/$ui_dir/setMillionsOfTrackSlots $adept_million_track_slots
/$ui_dir/setMillionsOfHitSlots $adept_million_hit_slots
/$ui_dir/setCUDAStackLimit 8192

# If true, particles are transported on the GPU across the whole geometry, GPU regions are ignored
/$ui_dir/setTrackInAllRegions true
# In order to do the GPU transport only in specific regions
#/$ui_dir/addGPURegion EcalRegion
#/$ui_dir/addGPURegion HcalRegion


## -----------------------------------------------------------------------------
## Optionally, set a constant magnetic filed:
## -----------------------------------------------------------------------------
/detector/setField $magnetic_field
#/detector/setField 0 0 3.8 tesla

## -----------------------------------------------------------------------------
## Set secondary production threshold, init. the run and set primary properties
## -----------------------------------------------------------------------------
/run/setCut 0.7 mm
/run/initialize

## User-defined Event verbosity: 1 = total edep, 2 = energy deposit per placed sensitive volume
/eventAction/verbose 1

/gun/hepmc
/generator/hepmcAscii/maxevents 256
/generator/hepmcAscii/firstevent 0
/generator/hepmcAscii/open ppttbar.hepmc3
/generator/hepmcAscii/verbose 0

## -----------------------------------------------------------------------------
## Run the simulation with the given number of events and print list of processes
## -----------------------------------------------------------------------------

/$ui_dir/setSeed $random_seed

# run events with parametrised simulation
# by default all created models are active
/run/beamOn $num_events

